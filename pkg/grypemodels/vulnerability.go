package grypemodels

import "github.com/samber/lo"

type Vulnerability struct {
	VulnerabilityMetadata
	Fix        Fix        `json:"fix"`
	Advisories []Advisory `json:"advisories"`
	Risk       float64    `json:"risk"`
}

func (v Vulnerability) GetCVSSVector() string {
	cv, ok := lo.First(v.Cvss)

	if ok {
		return cv.Vector
	}

	return ""
}

func (v Vulnerability) GetCVSSScore() float64 {
	cv, ok := lo.First(v.Cvss)

	if ok {
		return cv.Metrics.BaseScore
	}

	return -1
}

type Fix struct {
	Versions []string `json:"versions"`
	State    string   `json:"state"`
}

type Advisory struct {
	ID   string `json:"id"`
	Link string `json:"link"`
}
